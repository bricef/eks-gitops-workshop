apiVersion: kuma.io/v1alpha1
kind: TrafficRoute
metadata:
  name: frontend-to-backend
  namespace: kuma-demo
mesh: default
spec:
  sources:
  - match:
      kuma.io/service: frontend_kuma-demo_svc:80
  destinations:
  - match:
      kuma.io/service: backend_kuma-demo_svc:3001
  conf:
  # it is NOT a percentage. just a positive weight
  - weight: 80
    destination:
      kuma.io/service: backend_kuma-demo_svc:3001
      version: 'v0'
  # we're NOT checking if total of all weights is 100
  - weight: 20
    destination:
      kuma.io/service: backend_kuma-demo_svc:3001
      version: 'v1'
  # 0 means no traffic will be sent there
  - weight: 0
    destination:
      kuma.io/service: backend_kuma-demo_svc:3001
      version: 'v2'
